<div class="card shadow-lg border-0 rounded-3">
    <div class="card-header bg-purple text-white d-flex justify-content-between align-items-center">
        <h4 class="mb-0">M√©todos de Pagamento</h4>
        <button class="btn btn-light text-purple fw-bold" data-bs-toggle="modal" data-bs-target="#paymentModal" data-mode="create">
            ‚ûï Adicionar
        </button>
    </div>

    <div class="card-body bg-dark text-light">
        <table class="table table-dark table-hover table-sm align-middle mb-0">
            <thead class="bg-purple text-white">
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Taxa Interna (%)</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="main-methods">
                {% for method in payment_methods|slice:":3" %}
                <tr>
                    <td>{{ method.id }}</td>
                    <td>{{ method.name }}</td>
                    <td>{{ method.internal_fee }}%</td>
                    <td>
                        <button class="btn btn-sm btn-outline-warning text-white"
                                data-bs-toggle="modal"
                                data-bs-target="#paymentModal"
                                data-mode="edit"
                                data-id="{{ method.id }}"
                                data-name="{{ method.name }}"
                                data-internal-fee="{{ method.internal_fee }}"
                                data-type="{{ method.type }}"
                                data-min-installment-amount="{{ method.min_installment_amount }}"
                                data-max-installments="{{ method.max_installments }}"
                                data-no-interest-installments="{{ method.no_interest_installments }}"
                                data-customer-interest-rate="{{ method.customer_interest_rate }}"
                                data-active="{{ method.is_active }}">
                            ‚úèÔ∏è
                        </button>
                        <button class="btn btn-sm btn-outline-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#deletePaymentModal"
                                data-id="{{ method.id }}">
                            üóëÔ∏è
                        </button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center text-muted">Nenhum m√©todo de pagamento encontrado.</td>
                </tr>
                {% endfor %}
            </tbody>
            {% if payment_methods|length > 3 %}
            <tbody id="extra-methods" style="display: none;">
                {% for method in payment_methods|slice:"3:" %}
                <tr>
                    <td>{{ method.id }}</td>
                    <td>{{ method.name }}</td>
                    <td>{{ method.internal_fee }}%</td>
                    <td>
                        <button class="btn btn-sm btn-outline-warning text-white"
                                data-bs-toggle="modal"
                                data-bs-target="#paymentModal"
                                data-mode="edit"
                                data-id="{{ method.id }}"
                                data-name="{{ method.name }}"
                                data-internal-fee="{{ method.internal_fee }}"
                                data-type="{{ method.type }}"
                                data-min-installment-amount="{{ method.min_installment_amount }}"
                                data-max-installments="{{ method.max_installments }}"
                                data-no-interest-installments="{{ method.no_interest_installments }}"
                                data-customer-interest-rate="{{ method.customer_interest_rate }}"
                                data-active="{{ method.is_active }}">
                            ‚úèÔ∏è
                        </button>
                        <button class="btn btn-sm btn-outline-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#deletePaymentModal"
                                data-id="{{ method.id }}">
                            üóëÔ∏è
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
            {% endif %}
        </table>

        {% if payment_methods|length > 3 %}
        <div class="text-center mt-2">
            <button class="btn btn-outline-light btn-sm" id="showMoreBtn" onclick="toggleExtraMethods(event)">
                Exibir mais
            </button>
        </div>
        {% endif %}
    </div>
</div>

{% include 'report/modals/payment_form.html' %}
{% include 'report/modals/payment_delete.html' %}

<script>
function toggleExtraMethods(event) {
    event.preventDefault();
    const extra = document.getElementById('extra-methods');
    const btn = document.getElementById('showMoreBtn');
    if (extra.style.display === 'none') {
        extra.style.display = '';
        btn.textContent = 'Exibir menos';
    } else {
        extra.style.display = 'none';
        btn.textContent = 'Exibir mais';
    }
}
</script>
